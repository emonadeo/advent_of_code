import common
import day_10
import gleam/dict
import gleeunit/should

pub fn score_map_test() {
  common.matrix_to_map([
    [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 8],
  ])
  |> day_10.score_map()
  |> should.equal(
    dict.from_list([
      #(#(0, 0), 2),
      #(#(0, 1), 2),
      #(#(0, 2), 2),
      #(#(0, 3), 2),
      #(#(0, 4), 2),
      #(#(0, 5), 2),
      #(#(0, 6), 2),
      #(#(0, 7), 2),
      #(#(0, 8), 2),
      #(#(0, 9), 1),
      #(#(1, 0), 1),
      #(#(1, 1), 1),
      #(#(1, 2), 1),
      #(#(1, 3), 1),
      #(#(1, 4), 1),
      #(#(1, 5), 1),
      #(#(1, 6), 1),
      #(#(1, 7), 1),
      #(#(1, 8), 1),
      #(#(1, 9), 2),
    ]),
  )

  common.matrix_to_map([[0, 1, 2, 3], [7, 6, 5, 4], [8, 9, 8, 0]])
  |> day_10.score_map()
  |> should.equal(
    dict.from_list([
      #(#(0, 0), 1),
      #(#(0, 1), 1),
      #(#(0, 2), 1),
      #(#(0, 3), 1),
      #(#(1, 3), 1),
      #(#(1, 2), 1),
      #(#(1, 1), 1),
      #(#(1, 0), 1),
      #(#(2, 0), 1),
      #(#(2, 1), 1),
      #(#(2, 2), 1),
    ]),
  )

  let height_map =
    common.matrix_to_map([
      [8, 9, 0, 1, 0, 1, 2, 3],
      [7, 8, 1, 2, 1, 8, 7, 4],
      [8, 7, 4, 3, 0, 9, 6, 5],
      [9, 6, 5, 4, 9, 8, 7, 4],
      [4, 5, 6, 7, 8, 9, 0, 3],
      [3, 2, 0, 1, 9, 0, 1, 2],
      [0, 1, 3, 2, 9, 8, 0, 1],
      [1, 0, 4, 5, 6, 7, 3, 2],
    ])
  height_map
  |> day_10.score_map()
  |> day_10.zero_height(height_map)
  |> should.equal(
    dict.from_list([
      #(#(0, 2), 5),
      #(#(0, 4), 6),
      #(#(2, 4), 5),
      #(#(4, 6), 3),
      #(#(5, 2), 1),
      #(#(5, 5), 3),
      #(#(6, 0), 5),
      #(#(6, 6), 3),
      #(#(7, 1), 5),
    ]),
  )
}
